
@{
    ViewData["Title"] = "DetalleGrupo";
}

@if (ViewBag.error == null){
    <div class="container" style="margin:1em;">
        <div class="col-md-12 row" style="background-color: #e5e5e5;padding:1em;border-radius: 25px;border-radius: 25px;opacity:.9;">
            <div class="col-md-5 col-md-offset-5"></div>
            <h1><label><strong>Detalle Grupo</strong></label></h1>
            @if (ViewBag.dictamen != null)
            {
                @if (ViewBag.dictamen == true)
                {
                    <label class="badge badge-success" style="height: 21px;">APROBADO</label>
                }
                else
                {
                    <label class="badge badge-danger" style="height: 21px;">DENEGADO</label>
                }
            }
            <!---->
        </div>
    </div>
    <div class="container" style="margin-bottom:.5em;" align="center">
        <div class="col-md-12 row" style="background-color: #f5f5f5;padding:1em;border-radius: 25px;opacity:.9;">
            <div class="col-md-1"></div>
            <div class="col-md-10">
                <label><strong>INFORMACIÓN:</strong></label><br />
                <table class="table table-striped table-sm">
                    <thead>
                        <tr>
                            <th width="50%">Nombre de Grupo</th>
                            <th width="30%" align="center">No. de Integrantes</th>
                            <th width="20%">Importe Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>@ViewBag.solicitudes[0].grupoNombre</td>
                            <td align="center">@ViewBag.solicitudes.Count</td>
                            <td align="right">@string.Format("{0:#,0.00}", ViewBag.importeTotal)</td>
                        </tr>
                    </tbody>
                </table>
                <label><strong>INTEGRANTES:</strong></label>
                <table class="table table-striped table-sm">
                    <thead>
                        <tr>
                            <th width="15%">Status</th>
                            <th width="50%">Nombre</th>
                            <th width="15%">Importe</th>
                            <th width="10%">Acción</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (Solicitud solicitud in ViewBag.solicitudes)
                        {
                            <tr>
                                <td>
                                    @switch (solicitud.status)
                                    {
                                        case 2:
                                            <span class='badge badge-success'>APROBADO</span>
                                            break;
                                        case 3:
                                            <span class='badge badge-danger'>DENEGADO</span>
                                            break;
                                        case 6:
                                            <span class='badge badge-warning'>REVISIÓN</span>
                                            break;
                                        case 7:
                                            <span class='badge badge-secondary'>EN ESPERA DE C. DE BURO</span>
                                            break;
                                        case 8:
                                            <span class='badge badge-secondary'>EN PROCESO DE C. DE BURO</span>
                                            break;
                                        case 9:
                                            <span class='badge badge-primary'>POR DICTAMINAR</span>
                                            break;
                                        case 10:
                                            <span class='badge badge-danger'>ERROR EN C. DE BURO</span>
                                            break;
                                        default:
                                            <span class='badge badge-info'>POR AUTORIZAR C. DE BURÓ</span>
                                            break;
                                    }
                                </td>
                                <td>@(solicitud.persona.nombre + " " + solicitud.persona.nombreSegundo + " " + solicitud.persona.apellido + " " + solicitud.persona.apellidoSegundo)</td>
                                <td align="right">@string.Format("{0:#,0.00}", solicitud.importe)</td>
                                <td><center><a href='/Bandeja/Detalle/?_ID=@solicitud.solicitudID' target='_blank'>VER</a></center></td>
                            </tr>
                        }
                    </tbody>
                </table>
                <br />
                @if (ViewBag.dictaminable == true && ViewBag.dictamen == null)
                {
                <center id="botonera">

                    <a href="/Bandeja/grupoDictamen/?_ID=@ViewBag.solicitudes[0].grupoID&aut=1" class="btn btn-success btn_APRGPO">APROBAR GRUPO</a>

                    <a href="/Bandeja/grupoDictamen/?_ID=@ViewBag.solicitudes[0].grupoID&aut=0" class="btn btn-danger btn_DENGPO">DENEGAR GRUPO</a>

                </center>
                }
                else if(ViewBag.dictamen != null)
                {
                    <label>*Grupo Dictaminado</label>
                }
                else
                {
                    <label>*Es necesario aprobar o denegar a cada intengrate para dictaminar el grupo</label>
                }
            </div>
            <div class="col-md-1"></div>
        </div>
    </div>
}
else
{
    <div style="background-color: lightcoral;color:white; padding:1em;" align="center"><strong>Error: @ViewBag.error</strong></div>
}

<script>
    $(".btn_DENGPO").click(function (e) {
        var res = confirm("Esta a punto de DENEGAR el grupo.\n\n\nPara Confirmar de clic en 'ACEPTAR'");
        if (res) {
            $("#botonera").html("<strong>CARGANDO ...</strong>");
        }
        console.log(res);
        return res;
    });
    $(".btn_APRGPO").click(function (e) {
        var res = confirm("Esta a punto de APROBAR el grupo.\n\n\nPara Confirmar de clic en 'ACEPTAR'");
        if (res) {
            $("#botonera").html("<strong>CARGANDO ...</strong>");
        }
        console.log(res);
        return res;
    })
</script>
